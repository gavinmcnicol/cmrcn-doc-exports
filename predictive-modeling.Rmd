---
title: "RCN DOC Exports - Predictive Modeling"
author: "Gavin McNicol"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: journal
    highlight: monochrome
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Purpose

Code for predictive modeling of stream dissolved organic carbon (DOC) using random forest and spatial (forward) feature selection in support of the manuscript:

*Carbon Export along Coastal Temperate Rainforest Margins Dominated by Small Watersheds* by G. McNicol, E. Hood, D. E. Butman, S. Tank, I.J.W. Giesbrecht, W. Floyd, D. Dâ€™Amore, J.B. Fellman (2022-2023)

## Analysis

```{r load-packages, include = F}
source("code/libraries.R") # loads packages as pkg_req
lapply(pkg_req, require, character.only = TRUE)
if(pkg_req %in% (.packages())){
  pkg_req_true = "Yes"
} else{
  pkg_req_true = "No"
}
```

Packages loaded: `r pkg_req_true`

```{r load-mytheme, include = F}
source("code/mytheme.R")  # loads ggplot theme
```

### Load and View DOC Data

```{r load-doc, echo = F, message = F}
doc <- read_csv("data/annual-doc-yield.csv") %>% 
  dplyr::select(IP_ID, Use, DOC_yield = annual_DOC_yield, DOC_yield_sd = sd_annual_DOC_yield)
glimpse(doc)
```


### Load and View Predictive Features

Exclude geolocation features: `Poly_x`, `Poly_y`, `Cluster`

```{r load-predictors, echo = F, message = F}
feat <- read_csv("data/WtsData_For_RCN_DOCflux.csv") %>% 
  dplyr::select(-"Poly_x", -"Poly_y", -"Cluster")
glimpse(feat)
```

#### Feature Objects

```{r subset-features, include = F}
# combine features 
feat_names <- feat %>% 
  dplyr::select(-IP_ID) %>% 
  names()
feat_l <- length(feat_names)
```

Num. of features = `r feat_l`  

Feature names: `r cbind(feat_names)`





